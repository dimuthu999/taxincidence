---
title: "Anchoring in Housing Market: Evidence from California Proposition 13"
author: "Dimuthu Ratnadiwakara and Vijay Yerramilli"
date: "April, 2017"
output:
  html_document:
    css: bodycss.css
    fig_height: 6
    fig_width: 12
    number_section: yes
    toc: yes
  pdf_document:
    toc: yes
  word_document:
    toc: yes
linestretch: 2
bibliography: C:\Users\dnratnadiwakara\OneDrive\library.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE,echo = FALSE)
```

```{r init}

rm(list=ls())
path = "E:/tax_incident/"
setwd(path)
library(plyr)
library(psych)
library(stargazer)
library(Matching)
library(sandwich)
library(ggplot2)
library(scales)
library(lubridate)
library(zoo)
library(AER)
library(lfe)
library(pracma)
library(dplyr)
library(ggmap)
library(reshape2)

output.type="text"

completeFun <- function(data, desiredCols) {
  completeVec <- complete.cases(data[, desiredCols])
  return(data[completeVec, ])
}

sold_data <- readRDS(file="ca_anchoring_4.rds")
sold_data <- sold_data[sold_data$state %in% c("TN","CA"),]
sold_data['tax_pct'] <- sold_data$proptax_2015/sold_data$current_value
sold_data <- sold_data[sold_data$tax_pct>=quantile(sold_data$tax_pct,0.01,na.rm = TRUE) & sold_data$tax_pct<=quantile(sold_data$tax_pct,0.99,na.rm = TRUE),]
sold_data <- sold_data[sold_data$sales_price>=quantile(sold_data$sales_price,0.01,na.rm = TRUE) & sold_data$sales_price<=quantile(sold_data$sales_price,0.99,na.rm = TRUE),]
sold_data['delete'] <- ifelse(sold_data$Lastremodelyear>sold_data$purchased_year,1,0)
sold_data <- sold_data[sold_data$delete ==0 | is.na(sold_data$delete),]
sold_data$delete <- NULL
sold_data <- sold_data[is.finite(log(sold_data$listing_amount)),]
sold_data <- sold_data[is.finite(log(sold_data$current_value)),]
sold_data <- sold_data[is.finite(log(sold_data$sales_price)),]
sold_data <- sold_data[!is.na(sold_data$zip_purchased_year),]
sold_data <- sold_data[!is.na(sold_data$zip_listed_year),]

sold_data <- completeFun(sold_data,c("sales_price","beds","baths","sqft","age","zip_listed_year","walk_score","avg_school_rating","avg_school_distance","Lot"))

sales_price_estimate <- lm(sales_price~beds+baths+age+walk_score+Lot+avg_school_rating+avg_school_distance+listed_hpi+factor(zip_listed_year),data=sold_data)
sold_data['estimated_value'] <- predict(sales_price_estimate)
low_liq <- 1:5
high_liq <- 6:10
```


# Introduction
Anchoring is a cognitive error described by behavioral finance in which individuals fixate on an arbitrarily chosen reference point (anchor) and insufficiently adjusting away from the anchor toward the true value. Anchoring is particularly relevent to a matching setting such as sale of residential housing where the fair market value of the house is not objectively determinable. The first value of the bidding process-the seller's asking price-might serve as an anchor. This paper investigages whether the initial listing price in house sales serves as an anchor for the buyer to judge the value of a property, and whether buyers are not be able to adjust sufficiently away from the anchor to arrive at a fair market price. A house is typically the largest single asset in a household’s portfolio  and housing as a whole is a significant fraction of aggregate wealth. The sale of a home is likely to be the most significant financial transaction of most of the home owners’ lifetimes. According to Ferreira et al.(2008), over a two-year period, 12% home-owning households in the US move. Evidence consistent with anchoring effects suggests that home sellers would benefit from setting higher listing prices. 

@Tversky1974 first demonstrated anchoring using an experiment where they asked participants to estimate a number such as the percentage of African countries that are members of United Nations. The experiment began with the subjects being given a number (between 1 and 100) generated by the spin of a wheel. It turned out that the subjects showed a bias in their final estimates toward the number they were originally given. In another test, participants were asked to compute, within 5 seconds, the product of the numbers one through eight, either as 1x2x3x4x5x6x7x8 or reversed as 8x7x6x5x4x3x2x1. Because participants did not have enough time to calculate the full answer, they had to make an estimate after their first few multiplications. When these first multiplications gave a small answer – because the sequence started with small numbers – the median estimate was 512; when the sequence started with the larger numbers, the median estimate was 2,250. (The correct answer was 40,320.). 


Much of the research on decision bias is based upon individuals making decisions under the controlled and degraded or informationally impoverished conditions of the laboratory (@Tversky1974,@Northcraft1987,@Black1996). @Northcraft1987 experimental study based on one property in Tucson, Arizona. Amateur (48 students) and expert (21 real estate agents) subjects recived same 10 page packet of information except for the listing price. Four listing prices, low, moderately low, moderately high, high. After receiving the packet, subjects were allowed to examine the house, surrounding properyt and neighborhood for 20 mins. They found that estimates of both subject populations were significantly biased by listing prices. @Black1996's analysis of data gathered through a series of experiments revealed that the manipulation of asking price led to the manipulation of both buyer opening offer and eventual settlement prices, thus indicating the use of asking price as a shortcut and its strong potential as an agent for bias.

Laboratory results demonstrating a relationship between opening prices and selling prices are generally dismissed as the product of experimental demand in absence of real market conditions. It has been argued that decisional biases may disapper once decision makers are placed in the information-rich context in which actual decisions are made. Therefore demonstrating anchoring effects using market data is important to understanding anchoring effects. Papers such as @Genesove2001, @Bokhari2011 and @Bucchianeri2013 present evidence consistent with anchoring effects in housing markets. However these studies fail to sufficiently control for potential confounds. The main challenge in demonstrating anchoring effects using market data is one of showing that the relationship between listing prices and selling prices does not simply arise from objective home qualities. Therefore, to identify the effect of listing price we first must identify the sale price that a given home should command based on objective characteristics if listing behaviors had no impact. Eventhough the previous studies have attempted to control for unobservable home characteristics by including the residual from purchase price predictions as a control, none of these studies control for seller heterogeneity. Variations in the list price of similar properties might be due to random seller errors or sellers' strategic behavior. High seller motivation (urgency) might result in list price reductions or acceptance of a lower offer which may introduce a downward bias in the anchoring effect estimate (@Quan1991, @Glower1998, @Yavas1995, @Knight2002). Similarly a seller who can wait for a high-paying buyer may post a high asking price to attract only those buyers that would value his or her property higher than the going market value. Further real estate agents motiviations may impact the estimates. Arnold (1992) shows that the agent's reservation price for the seller's house is generally different than the seller's reservation price and agent may convince the seller to accept a lower offer (@Rutherford2005).

Proposition 13,passed in 1978, created unusually wide variation in property tax rates in California. Proposition 13 limits the property tax to a uniform 1% fixed rate, based on prices at the time of purchase. As a result two similar houses in the same area would have different property tax bills depending on the house prices at the time of purchase. The difference in the property tax is not related to the unobservable house or seller characteristics. We use this exogenous property tax component as in instrument variable for the listing price. The intuition of the instrumental variable is that the difference in property tax is not endogenously determined as the housing price component, and therefore is uncorrelated with characteristics of the house, neighborhood or the seller.

[Summary of results]

# California Proposition 13
Proposition 13, which is officially called the People's Initiative to Limit Property Taxation, was enacted in 1978 and it limits the maximum amount of tax on real property to be 1% and annual increase in the assesment value to 2%. A reassesment of the property is allowed only following an ownership change or new construction[@Oakland1979]. This leads to a situation where two similar houses in the same community whose residents have access to the same bundle of local public services paying significantly different tax amounts. The residents in the house that was purchased when the house prices are higher gets a larger tax bill compared to the residents in a similar house in the same community which was purchased way back when the house prices were low. 

According to the California Constitution, Article XIIIa, Proposition 13 states that “the maximum amount of any ad valorem tax on real property shall not exceed one percent (1%) of the full cash value of such property”. Full cash value means price at the time of purchase plus a maximum inflation adjustment of 2% per year. No re- assessment could be carried out, implying that property taxes are effectively frozen (apart from the 2% per year rise). Also, the initial base values used to set property taxes were the assessed housing values of 1975/1976


# Empirical Strategy
The exogenous property tax component due to Proposition 13 in California is used as an instrument to solve the main identification problem  - the correlation between price and unobserved housing, seller and agent characteristics.

We argue that the sellers are more likely to list the houses for a higher price if they have paid a higher amount as property tax in the last several years. Of course, for the sellers the property tax paid is a "sunk cost" and according to traditional microeconomic theory, sunk costs should not influence the seller's listing price. However, evidence from behavioral economics (Knox and Inkster (1968), Staw and Fox (1976),Arkes and Blumer (1985), Whyte (1986)) suggest that sunk costs do, in fact, influence people's decisions because humans are prone to loss aversion and framing effects ((Kahneman and Tverksy 1979, Tversky and Kahneman 1991). 


To show the difference in the property taxes we use an example of two houses in Anaheim California which were sold recently. Both these houses were sold for similar amounts in January 2016 and December 2015. Both houses have 3 bedrooms and 2 bath rooms and both were built in 1955. Observable characteristics of these two houses are as follows.

|809 S Velare St|2516 W Merle Pl|
|---------------|---------------|
|3 beds, 2 baths|3 beds, 2 baths|
|1,125 sqft|1,610 sqft|
|Built in 1955|Built in 1955|
|Previouse Sales 2005 (\$550,000), 2009 (\$282,000)|None|
|Sales Price \$ 482,000 (2016)|Sales Price \$ 485,000 (2016)|

Following figures shows that these two houses look very similar from the outside and are very close to each other and therefore we can assume they have access to the same bundle of local public services. 

![Figure 1: Two recently sold houses in Anaheim, CA](C:/Users/dnratnadiwakara/OneDrive/taxincidence/map.png)

![Figure 2: Two recently sold houses in Anaheim, CA](C:/Users/dnratnadiwakara/OneDrive/taxincidence/outside.png)

Since both these houses have very similar theoritically the property taxes paid by the homeonwers should be very similar. The figure below shows the differences in property taxes for these two houses due to proposition 13. House 2 (2516 W Merle Pl) was never sold in the past and therefore it is subject to the maximum of 2% appreciation of assesment value even when the house prices were increasing at significantly higher rates.  House 1 (809 S Velare St), on the other hand, was sold for 550,000 in 2005 and 282,000 in 2009 which reset the assesment value of the house according to the proposisiotn 13.  We can see that property tax bill for house 1 is significantly higher following the sale in 2005 and it was significantly reduced (but still higher than house 2) following the sale in 2009 for a low amount. 

```{r example}
years <- 2005:2015
house1 <- c(2012,5960,6321,5194,5194,3274,3325,3325,3366,3374,3688)
house2 <- c(762,786,816,816,849,887,938,938,983,1019,1065)
temp <- rbind(years,house1)
temp <- as.data.frame(t(rbind(temp,house2)))
ggplot(temp,aes(x=years))+ geom_line(aes(y=temp$house1,color="809 S Velare St"))+ geom_line(aes(y=temp$house2,color="2516 W Merle Pl"))+labs(y = "Properyt Taxes ($)",x = "Tax Year",colour = NULL)+theme(legend.position="bottom",legend.direction="horizontal",legend.title=element_blank(),        axis.ticks.y=element_blank(),legend.key.width=unit(5,"line"),legend.key = element_blank())+ggtitle("Property Tax Payments")

```


The figure below shows the 




```{r}
temp <- sold_data[sold_data$state=="CA",]
temp['purchased_year_cat'] <- ifelse(temp$purchased_year<=1998,"1995-1998",                                  ifelse(temp$purchased_year<=2002,"1999-2002",ifelse(temp$purchased_year<=2006,"2003-2006",ifelse(temp$purchased_year<=2010,"2007-2010","2011-2012"))))
temp <- ddply(temp,.(purchased_year),summarise,proptax_2015 = mean(proptax_2015),current_value=mean(current_value),taxpct = proptax_2015*100/current_value,taxpct_2010 = mean(proptax_2015_2010*100/(current_value)),hpi=mean(purchased_hpi,na.rm=TRUE))
# stargazer((temp),summary = FALSE,type=output.type)
# temp <- temp[,c("purchased_year","taxpct","hpi")]
ggplot(temp,aes(x=purchased_year))+ geom_line(aes(y=temp$taxpct,color="Tax Rate"))+ geom_line(aes(y=temp$taxpct_2010,color="Tax Rate 2010"))+geom_line(aes(y=temp$hpi/200,color="House Price Index")) + scale_y_continuous(sec.axis = sec_axis(~.*200, name = "House Price Index"))+labs(y = "Tax Rate in 2015 (%)",x = "Purchased Year",colour = NULL)+theme(legend.position="bottom",legend.direction="horizontal",legend.title=element_blank(),        axis.ticks.y=element_blank(),legend.key.width=unit(5,"line"),legend.key = element_blank())+ggtitle("Panel A: California")
```

```{r}
temp <- sold_data[sold_data$state=="TN",]
temp['purchased_year_cat'] <- ifelse(temp$purchased_year<=1998,"1995-1998",                                  ifelse(temp$purchased_year<=2002,"1999-2002",ifelse(temp$purchased_year<=2006,"2003-2006",ifelse(temp$purchased_year<=2010,"2007-2010","2011-2012"))))
temp <- ddply(temp,.(purchased_year),summarise,proptax_2015 = mean(proptax_2015),current_value=mean(current_value),taxpct = proptax_2015*100/current_value,taxpct_2010 = mean(proptax_2015_2010*100/(current_value)),hpi=mean(purchased_hpi,na.rm=TRUE))
# stargazer((temp),summary = FALSE,type=output.type)
temp <- temp[,c("purchased_year","taxpct","hpi")]
ggplot(temp,aes(x=purchased_year))+ geom_line(aes(y=temp$taxpct,color="Tax Rate"))+geom_line(aes(y=temp$hpi/200,color="House Price Index")) + scale_y_continuous(sec.axis = sec_axis(~.*200, name = "House Price Index"))+labs(y = "Tax Rate in 2015 (%)",x = "Purchased Year",colour = NULL)+theme(legend.position="bottom",legend.direction="horizontal",legend.title=element_blank(),        axis.ticks.y=element_blank(),legend.key.width=unit(5,"line"),legend.key = element_blank())+ggtitle("Panel B: Tennessee")


```

Lock-in effect on housing choice because of the implicit tax break enjoyed by homeowners living in the same house for a long time (@ferreira2010). Higher opportunity cost so older people may be reluctant to sell. [how does this effect the estimate?]

I find that anchoring effect estimates are significantly downward biased when not accounted for the price endogeneity.


# Identification Strategy

 

Listing price becomes a less credible estimate of the market value when the liquidity is higher.

List Price ~ Property Tax (First Stage)
Sales Price ~ Property Tax
Sales Price ~ Property Tax (split by liquidity)



Nevada(?)


While homeowners who had moved in the previous year paid an effective tax rate of 0.8% on average, households living in the same dwelling for more than a decade paid less than 0.44%.


Alternative Explanation: elderly households pay less property tax than younger house- holds, because of differences in tenure by age and these houses are poorly maintained. to rule out use the recently puchased houses.

In comparing current taxes with a counterfactual 1% of housing values as property taxes, t


# Results

## First Stage

Do households in California respond to the property tax variation
generated by Proposition 13? We are interested in the answer to this questionfor two reasons. First, itwill indicatewhetherornot this type of transaction cost has enough relevance to be included in a residential location decisionsmodel. Second, property taxes can only be used as an instrumental variable to solve the price endogeneity problemif both the tax benefit due to Proposition 13 is large and homeowners indeed respond to that variation in property taxes.

## Main Result

OLS estimates generate a relatively small user cost coefficient, indicating very high preferences for certain housing characteristics.

R2 of first stage is low. This suggests that listing price is not fully rational. 

```{r main_result}
temp <- sold_data[sold_data$state=="CA",]
dependent_var = "log(sales_price)"
endo_var = "log(listing_amount)"
instrument = "tax_pct+log(purchased_amount)+purchased_hpi"
controls = "log(current_value)|zip_listed_year+zip_purchased_year"
cluster_var = "zip_purchased_year"
controls2 = "listed_hpi+ownership_years+avg_school_rating+walk_score+Lot+baths+beds+age|zip_listed_year"

controls <- list()
controls[[1]] <- "0|zip_listed_year+zip_purchased_year"
controls[[2]] <- "log(current_value)|zip_listed_year+zip_purchased_year"
controls[[3]] <- "log(estimated_value)|zip_listed_year+zip_purchased_year"
controls[[4]] <- "listed_hpi+ownership_years+avg_school_rating+walk_score+Lot+baths+beds+age|zip_listed_year+zip_purchased_year"

ols_formula <- as.formula(paste(dependent_var,"~",endo_var,"+",controls[[2]],"|0|",cluster_var,sep=""))
fs_formula <- as.formula(paste(endo_var,"~tax_pct+log(purchased_amount)+purchased_hpi+",controls[[2]],"|0|",cluster_var,sep=""))
ss_formula <- as.formula(paste(dependent_var,"~",controls,"|(",endo_var,"~",instrument,")|",cluster_var,sep=""))
ss_formula2 <- as.formula(paste(dependent_var,"~",controls2,"|(",endo_var,"~",instrument,")|",cluster_var,sep=""))

main_result <- list()
main_result[[1]] <- felm(ols_formula,data =temp)
main_result[[2]] <- felm(fs_formula,data =temp )
main_result[[3]]  <- felm(as.formula(paste(dependent_var,"~",controls[[1]],"|(",endo_var,"~",instrument,")|",cluster_var,sep="")),data = temp)
main_result[[4]]  <- felm(as.formula(paste(dependent_var,"~",controls[[2]],"|(",endo_var,"~",instrument,")|",cluster_var,sep="")),data = temp)
main_result[[5]]  <- felm(as.formula(paste(dependent_var,"~",controls[[3]],"|(",endo_var,"~",instrument,")",sep="")),data = temp)
main_result[[6]]  <- felm(as.formula(paste(dependent_var,"~",controls[[4]],"|(",endo_var,"~",instrument,")|",cluster_var,sep="")),data = temp)

stargazer(main_result,type=output.type,dep.var.labels.include = FALSE,column.labels = c("OLS","First Stage","IV","IV"),no.space = TRUE,omit.stat = c("f","rsq","ser"))

condfstat(main_result[[3]])
condfstat(main_result[[4]])
condfstat(main_result[[5]])
condfstat(main_result[[6]])
```

# Liquidity Split
```{r liquidity_split}
temp <- sold_data[sold_data$state=="CA",]
dependent_var = "log(sales_price)"
endo_var = "log(listing_amount)"
instrument = "tax_pct+log(purchased_amount)+purchased_hpi"
cluster_var = "zip_purchased_year"

controls <- list()
controls[[1]] <- "0|zip_listed_year+zip_purchased_year"
controls[[2]] <- "log(current_value)|zip_listed_year+zip_purchased_year"
controls[[3]] <- "log(estimated_value)|zip_listed_year+zip_purchased_year"
controls[[4]] <- "listed_hpi+ownership_years+avg_school_rating+walk_score+Lot+baths+beds+age|zip_listed_year+zip_purchased_year"

main_result <- list()
main_result[[1]]  <- felm(as.formula(paste(dependent_var,"~",controls[[4]],"|(",endo_var,"~",instrument,")|",cluster_var,sep="")),data = temp[temp$inventory_decile %in% c(1,2,3),])
main_result[[2]]  <- felm(as.formula(paste(dependent_var,"~",controls[[4]],"|(",endo_var,"~",instrument,")|",cluster_var,sep="")),data = temp[temp$inventory_decile %in% c(8,9,10),])


stargazer(main_result,type=output.type,dep.var.labels.include = FALSE,no.space = TRUE,omit.stat = c("f","rsq","ser"))

condfstat(main_result[[1]])
condfstat(main_result[[2]])
```

